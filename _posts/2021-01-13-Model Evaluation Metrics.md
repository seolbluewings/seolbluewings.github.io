---
layout: post
title:  "Model Evaluation Metrics"
date: 2021-01-13
author: seolbluewings
comments : true
categories: 모델평가
---

[작성중...]

모델을 생성하는 과정에서 우리는 예측결과가 가장 좋은 모델을 생성하길 희망한다. 어떠한 예측 모델은 1가지 방법론으로만 만들어지는게 아니다. 분류 분석 문제에서 로지스틱 회귀를 사용할 수도 있고 랜덤 포레스트를 활용할 수도 있다. 즉, 하나의 문제를 해결하기 위해서 다양한 방법론을 활용할 수 있다.

게다가 한가지 방법론 내에서도 hyperparameter 값에 따라 생성가능한 모델의 개수는 무수히 많아질 수 있다. 그렇다면, 우리는 수많은 모델들 중에서 최적의 모델을 골라낼 수 있는 기준을 마련해야할 것이다.

기준을 설정하고 각 모델을 기준에 따라 비교하는 것을 모델 성능 평가라고 한다. 모델의 우수성을 판단할 수 있는 기준은 데이터 분석의 목적에 따라 달라진다. 따라서 우리는 다양한 방식의 모델 성능 평가 기준을 알고있어야 한다.

#### MSE

MSE(평균제곱오차)는 가장 대표적인 평가 기준이다. 가장 단순한 형태인 회귀분석을 진행한다고 가정해보자. 예를 들면, 고객 정보를 가지고 이 고객의 월카드사용금액을 예측하는 모델을 만들어낸다고 하자.

$$\mathcal{D}=\{(x_{1},y_{1}),...,(x_{n},y_{n})\}$$ 과 같이 데이터가 존재한다고 하자. 이 때, $$y_{i}$$는 $$x_{i}$$에 매칭되는 결과값이다. $$x_{i}$$는 고객의 정보일 것이고 $$y_{i}$$는 월카드사용금액인 셈이다. 예측을 위한 모델을 $$f$$ 라고 하자. 예측 모델의 성능을 측정하기 위해서는 예측값인 $$f(x) = \hat{y}$$ 값과 정답 $$y$$를 비교해야 한다.

이러한 상황에서 가장 빈번하게 쓰이는 성능 측정기준이 MSE(평균제곱오차)이며 다음과 같이 계산한다.

$$\text{MSE} = \frac{1}{n}\sum_{i=1}^{n}(y-\hat{y})^{2}$$

MSE 수식을 통해 확인할 수 있듯이, MSE는 정답에 가깝게 예측할 수록 그 값이 작아진다.

#### Accuracy

분류 문제에서는 MSE가 아닌 정확도(Accuracy)나 오차율(Error Rate)을 기준으로 삼는다. 이진분류, 다중분류 모두 활용 가능한 지표이다.

Accuaracy는 전체 데이터 중에서 정확하게 예측한 데이터 개수의 비율을 의미한다. Error Rate는 이와 반대로 전체 데이터 중에서 잘못 예측한 데이터 개수의 비율을 의미한다.

마찬가지로 $$\mathcal{D}=\{(x_{1},y_{1}),...,(x_{n},y_{n})\}$$ 과 같이 데이터가 존재한다고 하자. 대신 이 때 $$y_{i} \in \{0,1\} $$ 이라 하자. Accuracy와 Error Rate는 다음과 같이 계산할 수 있으며, Error Rate는 1-Accuarcy 값임을 알 수 있다.

$$
\begin{align}
\text{Accuracy} &= \frac{1}{n}\sum_{i=1}^{n}\mathbb{I}(\hat{y} \eq y) \nonumber \\
\text{Error Rate} &= \frac{1}{n}\sum_{i=1}^{n}\mathbb{I}(\hat{y} \neq y) \nonumber
\end{align}
$$

#### Recall, Precision, F1 Score

이 포스팅에서 가장 중요한 부분이다. 


#### 참조 문헌

1. [단단한 머신러닝](http://www.yes24.com/Product/Goods/88440860)