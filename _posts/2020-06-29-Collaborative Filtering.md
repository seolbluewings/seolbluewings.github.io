---
layout: post
title:  "협업 필터링(Collaborative Filtering)"
date: 2020-06-29
author: YoungHwan Seol
categories: Statistics
---

우리는 일상 생활 속에서 추천 시스템(Recommendation System)을 자주 접하게 된다. 영화를 선택하는 과정에서 플랫폼(왓챠 또는 넷플릭스)은 나에게 잘 맞을 것 같은 영화를 제시해준다. 인터넷에서 물건을 구매하는 과정에서도 내가 관심있을 것으로 여겨지는 상품을 추천 받는다. 일상 생활 속에서 수많은 추천 시스템을 접하고 있기 때문에 우리는 이 추천 시스템이 어떤 논리와 이론 속에서 구현되고 있는지 알고 있을 필요가 있다.

추천 시스템은 크게 2가지로 구분된다. 1. 콘텐츠 기반(Content-Based) 방법과 2. 협업 필터링(Collaborative Filtering)이 추천 시스템의 2가지 대분류다. 이 글에서는 협업 필터링에 대해서 알아보고자 한다. 협업 필터링은 다른 추천 시스템들보다 일반적으로 더 좋은 성능을 가진 것으로 알려져 있다.

#### 협업 필터링(Collaborative Filtering) 개요

협업 필터링의 가장 핵심 아이디어는 다음과 같다 : 과거에 비슷한 취향을 가진 사람들은 미래에도 비슷한 취향을 가질 것이다.

협업 필터링은 A고객의 과거 행동(구매 평가)을 분석하여 A고객과 각 제품간의 연결 수준(connections)을 파악하고 제품에 대한 다른 고객들의 평가를 바탕으로 A고객에게 적합할 것으로 판단되는 제품을 추천하는 알고리즘이다.

다음과 같은 예시를 통해 간단하게 살펴보자. 다음과 같이 A~C가 6개의 영화에 대한 평점을 다음과 같이 줬다고 가정하자. null이라 표현한 것은 해당 영화를 시청하지 않아 평점을 주지 않았다는 것을 의미한다.

|영화|라라랜드|파운더|조조래빗|조디악|블랙팬서|픽셀|
|:---: |:---: |:---:|:---:|:---:|:---:|:---:|
|A|5.0|4.5|4.0|3.5|null|1.0|
|B|4.5|null|3.5|4.0|null|0.5|
|C|1.0|1.5|null|1.0|4.0|4.0|

A는 블랙팬서를 B는 파운더와 블랙팬서를 C는 조조래빗을 보지 않았다. 평점을 바탕으로 생각해보면, A와 B의 영화 취향은 비슷한 것으로 보인다. 그래서 B에게 A가 높은 점수를 준 파운더를 추천해준다.

반면, A와 C, B와 C는 영화 취향이 서로 다른 것으로 보인다. 그렇기 때문에 C가 높이 평가한 블랙 팬서를 A와 B에게는 추천하지 않는다.

유사도는 코사인 유사도, 피어슨 상관계수 등을 이용할 수 있다. 이렇게 보면 정말 쉬워 보인다. 그런데 문제는 현실 세계에서는 회원이 3명, 영화는 6개인 경우는 절대 없다. 이것이 협업 필터링 방법의 첫번째 Challenge이다.

또한 세상에 영화는 무지하게 많다. 영화가 아닌 상품 추천의 경우를 생각해 보아도 마찬가지다. 그래서 위와 같이 고객-아이템(user-item) 행렬이 sparsity한 경우를 생각해야 한다. 우리는 절대 모든 영화를 시청할 수 없고 모든 상품을 경험해볼 수 없다. 각 고객이 평가하는 제품은 극히 소수에 불과하다. 따라서 현실 세계의 고객-아이템 행렬은 sparse matrix 이다.


#### Matrix Factorization













