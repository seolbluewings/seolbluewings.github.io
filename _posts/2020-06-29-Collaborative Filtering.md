---
layout: post
title:  "협업 필터링(Collaborative Filtering)"
date: 2020-06-29
author: YoungHwan Seol
categories: Statistics
---

우리는 일상 생활 속에서 추천 시스템(Recommendation System)을 자주 접하게 된다. 영화를 선택하는 과정에서 플랫폼(왓챠 또는 넷플릭스)은 나에게 잘 맞을 것 같은 영화를 제시해준다. 인터넷에서 물건을 구매하는 과정에서도 내가 관심있을 것으로 여겨지는 상품을 추천 받는다. 일상 생활 속에서 수많은 추천 시스템을 접하고 있기 때문에 우리는 이 추천 시스템이 어떤 논리와 이론 속에서 구현되고 있는지 알고 있을 필요가 있다.

추천 시스템을 관통하는 아이디어는 다음과 같다 : 과거에 비슷한 취향을 가진 사람들은 미래에도 비슷한 취향을 가질 것이다.

추천 시스템은 크게 2가지로 구분된다. 1. 콘텐츠 기반(Content-Based) 방법과 2. 협업 필터링(Collaborative Filtering)이 추천 시스템의 2가지 대분류다. 이 글에서는 협업 필터링에 대해서 알아보고자 한다. 협업 필터링은 다른 추천 시스템들보다 일반적으로 더 좋은 성능을 가진 것으로 알려져 있다.

#### 콘텐츠 필터링(Content Filtering)

콘텐츠 필터링은 사용자 또는 영화에 대한 프로필을 만드는 것으로 시작된다. 예를 들면, 영화에 대한 프로필은 영화의 장르, 출연배우, 박스오피스 순위 등이 될 수 있다. 사용자 프로필은 가입자가 서비스 가입 과정에서 제출한 설문조사(연령, 선호 장르 등...) 같은 것들이 될 수 있다.

이렇게 수집된 프로필을 바탕으로 사용자와 영화를 연결지을 수 있다. 만약 내가 실화 기반의 영화를 좋아한다고 설문에 응답했다면, 알고리즘은 나에게 실화 기반의 영화 범주에 포함되는 스포트라이트, 빅쇼트 같은 영화들을 추천하게 된다.

#### 협업 필터링(Collaborative Filtering)

콘텐츠 필터링은 영화나 사용자에 대한 명시적 프로필(explicit profiles)을 만들어냈다. 그러나 오로지 과거의 평점(product ratings)에 의존하는 (상거래의 경우 거래 내역) 알고리즘도 존재한다. 이것이 바로 협업 필터링(Collaborative Filtering)이다.

협업 필터링은 사용자와 영화 간 상호 의존성을 분석하고 이를 바탕으로 새롭게 사용자와 영화의 연결성 정도를 측정한다. 대표적인 협업 필터링 방식은 바로 잠재 요인 모델(latent factor model)이다.

잠재 요인 모델은 평점 패턴을 통해 20~100가지 요인(factor)를 추론하고 이를 바탕으로 사용자와 영화의 특징지어 평점을 설명해보고자 하는 시도다. 여기서 이야기하는 요인이란 것은 액션의 양, 주제의 깊이 등과 같이 완벽하게 정의될 수 없는 차원을 의미한다.

![CF](https://github.com/seolbluewings/seolbluewings.github.io/blob/master/assets/Latent_Factor.PNG?raw=true){:width="70%" height="70%"}{: .center}

그림과 같이 영화가 2차원(여성지향적vs남성지향적 & 생각을 요하는vs즐기는 용도)속에 존재한다고 생각해보자. 각 영화와 사용자는 이 4분면 내에서 어느 지점에 각자의 위치를 갖게 된다.

이 때, 사용자의 예상 평점은 영화의 평균 평점은 그래프 상에서 영화의 위치와 사용자 위치의 내적과 같다. 예를 들면, Gus는 <덤앤 더머>를 좋아할 것이고 <컬러 퍼플>을 싫어할 것이며, <브레이브 하트>에 대해서는 평균을 살짝 상회하는 평점을 줄 것이라는걸 기대해볼 수 있다.

#### Matrix Factorization













